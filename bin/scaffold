#!/bin/bash

set -eou pipefail

day=${1:-}

if [ -z "${day}" ]; then
  echo "One required argument: [day]"
  exit 1
fi

touch src/day${day}_part1.zig
touch src/day${day}_part2.zig

mkdir -p data/day${day}
echo "Replace me!" > data/day${day}/input.txt
echo "Replace me!" > data/day${day}/sample1.txt

cat <<EOF > src/day${day}_part1.zig
const std = @import("std");
const utils = @import("utils.zig");

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    defer _ = gpa.deinit();
    const allocator = gpa.allocator();

    const sample_buffer = try utils.readFilePath(allocator, "data/day${day}/sample1.txt");
    defer allocator.free(sample_buffer);
    const sample_answer = try solve(allocator, sample_buffer);
    const expected_sample_answer = 9999999999; // DEFINE ME
    if (sample_answer != expected_sample_answer) {
        return std.debug.print("Day ${day} Part 1 expected sample answer: {d}, got: {d}\n", .{ expected_sample_answer, sample_answer });
    }
    std.debug.print("Day ${day} Part 1 sample passed!\n", .{});

    const input_buffer = try utils.readFilePath(allocator, "data/day${day}/input.txt");
    defer allocator.free(input_buffer);
    const answer = try solve(allocator, input_buffer);
    std.debug.print("Day ${day} Part 1 answer: {d}\n", .{answer});
}

fn solve(_: std.mem.Allocator, _: []u8) !u64 {
  return 0;
}
EOF

cat <<EOF > src/day${day}_part2.zig
const std = @import("std");
const utils = @import("utils.zig");

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    defer _ = gpa.deinit();
    const allocator = gpa.allocator();

    const sample_buffer = try utils.readFilePath(allocator, "data/day${day}/sample1.txt");
    defer allocator.free(sample_buffer);
    const sample_answer = try solve(allocator, sample_buffer);
    const expected_sample_answer = 9999999999; // DEFINE ME
    if (sample_answer != expected_sample_answer) {
        return std.debug.print("Day ${day} Part 2 expected sample answer: {d}, got: {d}\n", .{ expected_sample_answer, sample_answer });
    }
    std.debug.print("Day ${day} Part 2 sample passed!\n", .{});

    const input_buffer = try utils.readFilePath(allocator, "data/day${day}/input.txt");
    defer allocator.free(input_buffer);
    const answer = try solve(allocator, input_buffer);
    std.debug.print("Day ${day} Part 2 answer: {d}\n", .{answer});
}

fn solve(_: std.mem.Allocator, _: []u8) !u64 {
  return 0;
}
EOF
